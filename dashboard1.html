<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Station Lavage â€” Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<style>
  :root {
    --bg: #0a0e17;
    --surface: #111827;
    --surface2: #1a2235;
    --border: #1e293b;
    --text: #e2e8f0;
    --text-dim: #64748b;
    --accent: #06b6d4;
    --accent2: #8b5cf6;
    --green: #10b981;
    --red: #ef4444;
    --orange: #f59e0b;
    --radius: 16px;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'DM Sans', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
  }

  .noise {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.03'/%3E%3C/svg%3E");
    pointer-events: none; z-index: 0;
  }

  .app { position: relative; z-index: 1; }

  /* Header */
  .header {
    display: flex; justify-content: space-between; align-items: center;
    padding: 24px 40px;
    border-bottom: 1px solid var(--border);
    background: rgba(17, 24, 39, 0.6);
    backdrop-filter: blur(20px);
    position: sticky; top: 0; z-index: 10;
  }

  .logo {
    display: flex; align-items: center; gap: 14px;
  }

  .logo-icon {
    width: 42px; height: 42px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border-radius: 12px;
    display: flex; align-items: center; justify-content: center;
    font-size: 20px;
  }

  .logo-text {
    font-weight: 700; font-size: 20px;
    letter-spacing: -0.5px;
  }

  .logo-text span { color: var(--accent); }

  .header-meta {
    display: flex; align-items: center; gap: 24px;
    font-family: 'Space Mono', monospace;
    font-size: 13px; color: var(--text-dim);
  }

  .live-dot {
    width: 8px; height: 8px; background: var(--green);
    border-radius: 50%; display: inline-block;
    animation: pulse 2s infinite;
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.4; }
  }

  /* Main */
  .main { padding: 32px 40px; max-width: 1600px; margin: 0 auto; }

  /* Period selector */
  .period-bar {
    display: flex; align-items: center; justify-content: space-between;
    margin-bottom: 32px;
  }

  .period-title {
    font-size: 28px; font-weight: 700; letter-spacing: -0.5px;
  }

  .period-title span { color: var(--accent); }

  .tabs {
    display: flex; gap: 4px;
    background: var(--surface);
    border-radius: 10px; padding: 4px;
    border: 1px solid var(--border);
  }

  .tab {
    padding: 8px 18px; border-radius: 8px;
    font-size: 13px; font-weight: 500;
    cursor: pointer; transition: all 0.2s;
    color: var(--text-dim); border: none; background: none;
  }

  .tab.active {
    background: var(--accent);
    color: #000; font-weight: 700;
  }

  .tab:hover:not(.active) { color: var(--text); }

  /* KPI Cards */
  .kpis {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 16px;
    margin-bottom: 32px;
  }

  .kpi {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 24px;
    position: relative;
    overflow: hidden;
    transition: transform 0.2s, border-color 0.2s;
  }

  .kpi:hover {
    transform: translateY(-2px);
    border-color: var(--accent);
  }

  .kpi-label {
    font-size: 12px; text-transform: uppercase; letter-spacing: 1px;
    color: var(--text-dim); margin-bottom: 10px;
    font-family: 'Space Mono', monospace;
  }

  .kpi-value {
    font-size: 32px; font-weight: 700;
    font-family: 'Space Mono', monospace;
    letter-spacing: -1px;
  }

  .kpi-sub {
    font-size: 13px; color: var(--text-dim); margin-top: 6px;
    display: flex; align-items: center; gap: 6px;
  }

  .kpi-badge {
    padding: 2px 8px; border-radius: 6px;
    font-size: 11px; font-weight: 700;
    font-family: 'Space Mono', monospace;
  }

  .kpi-badge.up { background: rgba(16, 185, 129, 0.15); color: var(--green); }
  .kpi-badge.down { background: rgba(239, 68, 68, 0.15); color: var(--red); }

  .kpi-glow {
    position: absolute; top: -40px; right: -40px;
    width: 100px; height: 100px;
    border-radius: 50%;
    filter: blur(40px); opacity: 0.15;
  }

  /* Charts area */
  .charts-row {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 16px;
    margin-bottom: 32px;
  }

  .card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 24px;
  }

  .card-header {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 20px;
  }

  .card-title {
    font-size: 16px; font-weight: 700;
  }

  .card-title small {
    color: var(--text-dim); font-weight: 400; font-size: 13px;
    margin-left: 8px;
  }

  .chart-container {
    position: relative; height: 280px;
  }

  /* Site comparison */
  .sites-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
    margin-bottom: 32px;
  }

  .site-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 24px;
  }

  .site-header {
    display: flex; align-items: center; gap: 12px;
    margin-bottom: 20px;
  }

  .site-dot {
    width: 12px; height: 12px; border-radius: 50%;
  }

  .site-name { font-weight: 700; font-size: 18px; }

  .site-stats {
    display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px;
    margin-bottom: 20px;
  }

  .site-stat-label {
    font-size: 11px; color: var(--text-dim);
    text-transform: uppercase; letter-spacing: 0.5px;
    font-family: 'Space Mono', monospace;
    margin-bottom: 4px;
  }

  .site-stat-value {
    font-size: 22px; font-weight: 700;
    font-family: 'Space Mono', monospace;
  }

  .site-chart { height: 180px; position: relative; }

  /* Daily table */
  .daily-table-wrap {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 24px;
    margin-bottom: 32px;
    overflow-x: auto;
  }

  table {
    width: 100%; border-collapse: collapse;
    font-family: 'Space Mono', monospace;
    font-size: 13px;
  }

  th {
    text-align: left; padding: 10px 12px;
    color: var(--text-dim); font-size: 11px;
    text-transform: uppercase; letter-spacing: 0.5px;
    border-bottom: 1px solid var(--border);
    font-weight: 400;
    position: sticky; top: 0; background: var(--surface);
  }

  td {
    padding: 10px 12px;
    border-bottom: 1px solid rgba(30, 41, 59, 0.5);
  }

  tr:hover td { background: rgba(6, 182, 212, 0.03); }

  .day-profit { color: var(--green); font-weight: 700; }
  .day-loss { color: var(--red); font-weight: 700; }

  /* YoY comparison */
  .yoy-section {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 24px;
    margin-bottom: 32px;
  }

  .yoy-chart { height: 300px; position: relative; }

  /* Projections */
  .projections {
    background: linear-gradient(135deg, rgba(6, 182, 212, 0.08), rgba(139, 92, 246, 0.08));
    border: 1px solid rgba(6, 182, 212, 0.2);
    border-radius: var(--radius);
    padding: 32px;
    margin-bottom: 32px;
  }

  .proj-grid {
    display: grid; grid-template-columns: repeat(4, 1fr); gap: 24px;
    margin-top: 20px;
  }

  .proj-item { text-align: center; }

  .proj-value {
    font-size: 28px; font-weight: 700;
    font-family: 'Space Mono', monospace;
    color: var(--accent);
  }

  .proj-label {
    font-size: 12px; color: var(--text-dim); margin-top: 4px;
    text-transform: uppercase; letter-spacing: 0.5px;
  }

  /* Animations */
  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .animate { animation: fadeUp 0.6s ease forwards; opacity: 0; }
  .d1 { animation-delay: 0.05s; }
  .d2 { animation-delay: 0.1s; }
  .d3 { animation-delay: 0.15s; }
  .d4 { animation-delay: 0.2s; }
  .d5 { animation-delay: 0.25s; }
  .d6 { animation-delay: 0.3s; }
  .d7 { animation-delay: 0.35s; }

  @media (max-width: 1200px) {
    .kpis { grid-template-columns: repeat(3, 1fr); }
    .charts-row, .sites-row { grid-template-columns: 1fr; }
    .main { padding: 24px 20px; }
  }

  @media (max-width: 768px) {
    .kpis { grid-template-columns: 1fr 1fr; }
    .proj-grid { grid-template-columns: 1fr 1fr; }
    .header { padding: 16px 20px; }
  }
</style>
</head>
<body>
<div class="noise"></div>
<div class="app">

  <!-- Header -->
  <header class="header">
    <div class="logo">
      <div class="logo-icon">ðŸš¿</div>
      <div class="logo-text">Station<span>Wash</span></div>
    </div>
    <div class="header-meta">
      <span><span class="live-dot"></span> DonnÃ©es live</span>
      <span>Les Pieux & Martinvast</span>
      <span>FÃ©vrier 2026</span>
    </div>
  </header>

  <div class="main">

    <!-- Period -->
    <div class="period-bar animate d1">
      <h1 class="period-title">FÃ©vrier <span>2026</span></h1>
      <div class="tabs">
        <button class="tab">Jour</button>
        <button class="tab active">Mois</button>
        <button class="tab">AnnÃ©e</button>
      </div>
    </div>

    <!-- KPIs -->
    <div class="kpis">
      <div class="kpi animate d1">
        <div class="kpi-glow" style="background:var(--accent)"></div>
        <div class="kpi-label">CA Total HT</div>
        <div class="kpi-value" style="color:var(--green)">12 978 â‚¬</div>
        <div class="kpi-sub">
          <span class="kpi-badge up">â–² rentable</span>
          <span>25 jours</span>
        </div>
      </div>
      <div class="kpi animate d2">
        <div class="kpi-glow" style="background:var(--accent2)"></div>
        <div class="kpi-label">CA CB Mensuel</div>
        <div class="kpi-value">15 573 â‚¬</div>
        <div class="kpi-sub">100% du CA</div>
      </div>
      <div class="kpi animate d3">
        <div class="kpi-glow" style="background:var(--orange)"></div>
        <div class="kpi-label">Moyenne / Jour</div>
        <div class="kpi-value">519 â‚¬</div>
        <div class="kpi-sub">CA HT quotidien</div>
      </div>
      <div class="kpi animate d4">
        <div class="kpi-glow" style="background:var(--green)"></div>
        <div class="kpi-label">Power Jets</div>
        <div class="kpi-value">9 338</div>
        <div class="kpi-sub">
          <span>LP: 5 678 Â· MV: 3 660</span>
        </div>
      </div>
      <div class="kpi animate d5">
        <div class="kpi-glow" style="background:var(--red)"></div>
        <div class="kpi-label">Pistes HP</div>
        <div class="kpi-value">8 378</div>
        <div class="kpi-sub">
          <span>LP: 2 160 Â· MV: 6 218</span>
        </div>
      </div>
    </div>

    <!-- Charts row -->
    <div class="charts-row">
      <div class="card animate d3">
        <div class="card-header">
          <div class="card-title">CA Journalier HT <small>FÃ©vrier 2026</small></div>
        </div>
        <div class="chart-container">
          <canvas id="dailyCA"></canvas>
        </div>
      </div>
      <div class="card animate d4">
        <div class="card-header">
          <div class="card-title">RÃ©partition CA</div>
        </div>
        <div class="chart-container">
          <canvas id="repartition"></canvas>
        </div>
      </div>
    </div>

    <!-- Sites comparison -->
    <div class="sites-row">
      <div class="site-card animate d4">
        <div class="site-header">
          <div class="site-dot" style="background:var(--accent)"></div>
          <div class="site-name">Les Pieux</div>
        </div>
        <div class="site-stats">
          <div>
            <div class="site-stat-label">Power Jet</div>
            <div class="site-stat-value">5 678</div>
          </div>
          <div>
            <div class="site-stat-label">Pistes HP</div>
            <div class="site-stat-value">2 160</div>
          </div>
          <div>
            <div class="site-stat-label">Total Passages</div>
            <div class="site-stat-value">8 838</div>
          </div>
        </div>
        <div class="site-chart"><canvas id="chartLP"></canvas></div>
      </div>
      <div class="site-card animate d5">
        <div class="site-header">
          <div class="site-dot" style="background:var(--accent2)"></div>
          <div class="site-name">Martinvast</div>
        </div>
        <div class="site-stats">
          <div>
            <div class="site-stat-label">Power Jet</div>
            <div class="site-stat-value">5 345</div>
          </div>
          <div>
            <div class="site-stat-label">Pistes HP</div>
            <div class="site-stat-value">2 390</div>
          </div>
          <div>
            <div class="site-stat-label">Total Passages</div>
            <div class="site-stat-value">7 735</div>
          </div>
        </div>
        <div class="site-chart"><canvas id="chartMV"></canvas></div>
      </div>
    </div>

    <!-- Daily Table -->
    <div class="daily-table-wrap animate d5">
      <div class="card-header">
        <div class="card-title">DÃ©tail Journalier <small>FÃ©vrier 2026</small></div>
      </div>
      <table>
        <thead>
          <tr>
            <th>Date</th>
            <th>CA CB</th>
            <th>CA EspÃ¨ces</th>
            <th>CA TTC</th>
            <th>CA HT</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody id="dailyTableBody"></tbody>
      </table>
    </div>

    <!-- YoY Comparison -->
    <div class="yoy-section animate d6">
      <div class="card-header">
        <div class="card-title">Ã‰volution CA HT Mensuel <small>Comparaison annuelle (historique ancien proprio)</small></div>
      </div>
      <div class="yoy-chart"><canvas id="yoyChart"></canvas></div>
    </div>

    <!-- Projections -->
    <div class="projections animate d7">
      <div class="card-header">
        <div class="card-title">ðŸ“ˆ Projections</div>
      </div>
      <div class="proj-grid">
        <div class="proj-item">
          <div class="proj-value">15 789 â‚¬</div>
          <div class="proj-label">CA HT prÃ©v. mensuel</div>
        </div>
        <div class="proj-item">
          <div class="proj-value">189 472 â‚¬</div>
          <div class="proj-label">CA HT prÃ©v. annuel</div>
        </div>
        <div class="proj-item">
          <div class="proj-value">183 064 â‚¬</div>
          <div class="proj-label">CA HT 2025/2026</div>
        </div>
        <div class="proj-item">
          <div class="proj-value" style="color:var(--green)">+5%</div>
          <div class="proj-label">vs ancien proprio</div>
        </div>
      </div>
    </div>

  </div>
</div>

<script>
// Chart.js global config
Chart.defaults.color = '#64748b';
Chart.defaults.borderColor = 'rgba(30,41,59,0.5)';
Chart.defaults.font.family = "'Space Mono', monospace";
Chart.defaults.font.size = 11;

// â”€â”€ DATA â”€â”€
const days = Array.from({length: 25}, (_, i) => i + 1);
const caCB = [709,497,503,902,318,656,1127,850,372,186,270,668,776,1168,246,550,738,160,366,708,426,198,482,1127,1570];
const caEsp = new Array(25).fill(0);
const caTTC = caCB.map((v,i) => v + caEsp[i]);
const caHT = [590.83,414.17,419.17,751.67,265.00,546.67,939.17,708.33,310.00,155.00,225.00,556.67,646.67,973.33,205.00,458.33,615.00,133.33,305.00,590.00,355.00,165.00,401.67,939.17,1308.33];

const breakeven = 400; // seuil approximatif

// â”€â”€ Daily CA Chart â”€â”€
new Chart(document.getElementById('dailyCA'), {
  type: 'bar',
  data: {
    labels: days,
    datasets: [{
      label: 'CA HT',
      data: caHT,
      backgroundColor: caHT.map(v => v >= breakeven ? 'rgba(16,185,129,0.7)' : 'rgba(239,68,68,0.6)'),
      borderRadius: 6,
      borderSkipped: false,
    }, {
      label: 'Seuil rentabilitÃ©',
      data: new Array(25).fill(breakeven),
      type: 'line',
      borderColor: 'rgba(245,158,11,0.6)',
      borderDash: [6, 4],
      borderWidth: 2,
      pointRadius: 0,
      fill: false,
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      legend: { display: false },
      tooltip: {
        callbacks: {
          label: ctx => ctx.dataset.label + ': ' + ctx.parsed.y.toFixed(2) + ' â‚¬'
        }
      }
    },
    scales: {
      y: {
        beginAtZero: true,
        grid: { color: 'rgba(30,41,59,0.3)' },
        ticks: { callback: v => v + 'â‚¬' }
      },
      x: { grid: { display: false } }
    }
  }
});

// â”€â”€ RÃ©partition Donut â”€â”€
new Chart(document.getElementById('repartition'), {
  type: 'doughnut',
  data: {
    labels: ['Les Pieux CB', 'Martinvast CB', 'EspÃ¨ces'],
    datasets: [{
      data: [7838, 7735, 0],
      backgroundColor: ['#06b6d4', '#8b5cf6', '#f59e0b'],
      borderWidth: 0,
      spacing: 4,
      borderRadius: 6,
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    cutout: '70%',
    plugins: {
      legend: {
        position: 'bottom',
        labels: { padding: 16, usePointStyle: true, pointStyleWidth: 10 }
      }
    }
  }
});

// â”€â”€ Site charts â”€â”€
const lpTotal = [310,274,277,466,148,382,617,439,188,138,148,371,318,534,134,228,422,42,204,364,200,126,230,548,730];
const mvTotal = [399,223,226,436,170,274,510,411,184,48,122,297,458,634,112,322,316,118,162,344,226,72,252,579,840];

function siteChart(id, data, color) {
  new Chart(document.getElementById(id), {
    type: 'line',
    data: {
      labels: days,
      datasets: [{
        data: data,
        borderColor: color,
        backgroundColor: color + '15',
        fill: true,
        tension: 0.4,
        borderWidth: 2,
        pointRadius: 0,
        pointHitRadius: 10,
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { display: false } },
      scales: {
        y: {
          beginAtZero: true,
          grid: { color: 'rgba(30,41,59,0.3)' },
          ticks: { display: false }
        },
        x: { grid: { display: false }, ticks: { maxTicksLimit: 8 } }
      }
    }
  });
}

siteChart('chartLP', lpTotal, '#06b6d4');
siteChart('chartMV', mvTotal, '#8b5cf6');

// â”€â”€ Daily Table â”€â”€
const tbody = document.getElementById('dailyTableBody');
days.forEach((d, i) => {
  const isProfit = caHT[i] >= breakeven;
  const tr = document.createElement('tr');
  tr.innerHTML = `
    <td>${d}/02/2026</td>
    <td>${caCB[i].toLocaleString('fr-FR')} â‚¬</td>
    <td>${caEsp[i]} â‚¬</td>
    <td>${caTTC[i].toLocaleString('fr-FR')} â‚¬</td>
    <td class="${isProfit ? 'day-profit' : 'day-loss'}">${caHT[i].toFixed(2)} â‚¬</td>
    <td>${isProfit ? 'ðŸŸ¢' : 'ðŸ”´'}</td>
  `;
  tbody.appendChild(tr);
});

// â”€â”€ YoY Chart â”€â”€
const months = ['Avr','Mai','Juin','Juil','AoÃ»t','Sep','Oct','Nov','DÃ©c','Jan','FÃ©v','Mar'];
const series = {
  '2019/2020': [3805,5390,5185,7805,6375,4597,4962,4115,7270,7636,5762,3478],
  '2020/2021': [1175,8635,5369,7849,7782,6287,5549,4980,6085,6802,9489,9621],
  '2021/2022': [8763,7984,8127,9846,9912,8924,7710,7253,8078,10303,9259,12275],
  '2022/2023': [10814,12750,9736,13519,9773,4024,6888,5721,7223,9641,11300,11907],
  '2023/2024': [16703,24374,25285,12691,14289,17290,14500,11117,18277,19249,15151,20182],
  '2024/2025': [20477,21244,20061,16852,17097,10855,20200,18883,15295,16802,18373,21500],
  '2025/2026': [22600,20700,18724,17585,26796,11162,14103,13155,20403,17836,null,null],
};

const colors = ['#94a3b8','#fb923c','#9ca3af','#fbbf24','#22c55e','#3b82f6','#06b6d4'];
const keys = Object.keys(series);

new Chart(document.getElementById('yoyChart'), {
  type: 'line',
  data: {
    labels: months,
    datasets: keys.map((k, i) => ({
      label: k,
      data: series[k],
      borderColor: colors[i],
      borderWidth: k === '2025/2026' ? 3 : 1.5,
      pointRadius: k === '2025/2026' ? 4 : 0,
      pointBackgroundColor: colors[i],
      tension: 0.3,
      borderDash: k === '2025/2026' ? [] : [4, 2],
      spanGaps: false,
    }))
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      legend: {
        position: 'bottom',
        labels: { padding: 16, usePointStyle: true, pointStyleWidth: 10 }
      },
      tooltip: {
        callbacks: {
          label: ctx => ctx.dataset.label + ': ' + (ctx.parsed.y ? ctx.parsed.y.toLocaleString('fr-FR') + ' â‚¬' : 'N/A')
        }
      }
    },
    scales: {
      y: {
        grid: { color: 'rgba(30,41,59,0.3)' },
        ticks: { callback: v => (v/1000).toFixed(0) + 'kâ‚¬' }
      },
      x: { grid: { display: false } }
    }
  }
});
</script>
</body>
</html>
